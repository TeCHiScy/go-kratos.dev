"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2],{3905:function(e,t,o){o.d(t,{Zo:function(){return d},kt:function(){return f}});var n=o(7294);function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function i(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function a(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?i(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)o=i[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),o=t;return e&&(o="function"==typeof e?e(t):a(a({},t),e)),o},d=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var o=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=s(o),f=r,m=c["".concat(p,".").concat(f)]||c[f]||u[f]||i;return o?n.createElement(m,a(a({ref:t},d),{},{components:o})):n.createElement(m,a({ref:t},d))}));function f(e,t){var o=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=o.length,a=new Array(i);a[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,a[1]=l;for(var s=2;s<i;s++)a[s]=o[s];return n.createElement.apply(null,a)}return n.createElement.apply(null,o)}c.displayName="MDXCreateElement"},5061:function(e,t,o){o.r(t),o.d(t,{assets:function(){return p},contentTitle:function(){return a},default:function(){return u},frontMatter:function(){return i},metadata:function(){return l},toc:function(){return s}});var n=o(3117),r=(o(7294),o(3905));const i={id:"faq",title:"FAQ",description:"Kratos FAQ",keywords:["Go","Kratos","Toolkit","Framework","Microservices","Protobuf","gRPC","HTTP"]},a=void 0,l={unversionedId:"intro/faq",id:"intro/faq",title:"FAQ",description:"Kratos FAQ",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/intro/03-faq.md",sourceDirName:"intro",slug:"/intro/faq",permalink:"/en/docs/intro/faq",draft:!1,editUrl:"https://github.com/go-kratos/go-kratos.dev/edit/main/i18n/en/docusaurus-plugin-content-docs/current/intro/03-faq.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{id:"faq",title:"FAQ",description:"Kratos FAQ",keywords:["Go","Kratos","Toolkit","Framework","Microservices","Protobuf","gRPC","HTTP"]},sidebar:"docs",previous:{title:"Design",permalink:"/en/docs/intro/design"},next:{title:"Layout",permalink:"/en/docs/intro/layout"}},p={},s=[{value:"1. <code>google/protobuf/descriptor.proto: File not found.</code> error while using <code>kratos proto</code> command.",id:"1-googleprotobufdescriptorproto-file-not-found-error-while-using-kratos-proto-command",level:3},{value:"2. There are errors from IDE show <code>import &quot;google/api/annotations.proto&quot;;</code> with red wavy line",id:"2-there-are-errors-from-ide-show-import-googleapiannotationsproto-with-red-wavy-line",level:3},{value:"3. Develop with goland",id:"3-develop-with-goland",level:3},{value:"4. The code newly generated after the new release is unavailable, with system alarming errors.",id:"4-the-code-newly-generated-after-the-new-release-is-unavailable-with-system-alarming-errors",level:3},{value:"5. After invoke <code>kratos client</code>, there are no deserved http file.",id:"5-after-invoke-kratos-client-there-are-no-deserved-http-file",level:3},{value:"6. It show <code>Command not found: kratos</code> after installed Kratos",id:"6-it-show-command-not-found-kratos-after-installed-kratos",level:3},{value:"7. It show some proto file not found when generate pb file.",id:"7-it-show-some-proto-file-not-found-when-generate-pb-file",level:3},{value:"8.There are  <code>// no validation rules for xxxx</code> for configurated property.",id:"8there-are---no-validation-rules-for-xxxx-for-configurated-property",level:3},{value:"9. Custom Http return value",id:"9-custom-http-return-value",level:3},{value:"10. How to control the http return field 0 value ignore field and use proto&#39;s message field as the http return field",id:"10-how-to-control-the-http-return-field-0-value-ignore-field-and-use-protos-message-field-as-the-http-return-field",level:3},{value:"11\u3001Controls the name and number of the enum (enumeration type) returned by http",id:"11controls-the-name-and-number-of-the-enum-enumeration-type-returned-by-http",level:3}],d={toc:s};function u(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h3",{id:"1-googleprotobufdescriptorproto-file-not-found-error-while-using-kratos-proto-command"},"1. ",(0,r.kt)("inlineCode",{parentName:"h3"},"google/protobuf/descriptor.proto: File not found.")," error while using ",(0,r.kt)("inlineCode",{parentName:"h3"},"kratos proto")," command."),(0,r.kt)("p",null,"This issue is mainly caused by the improperly installation of protoc. The documentation ",(0,r.kt)("a",{parentName:"p",href:"https://grpc.io/docs/protoc-installation/"},"protoc-installation")," shows the correct way to install protoc. It is highly recommended that install protoc by system package manager to ensure the installation's integrity. If you have to install the pre-compiled version, please refer to the ",(0,r.kt)("inlineCode",{parentName:"p"},"readme.txt")," in the zip file, make sure all the files under ",(0,r.kt)("inlineCode",{parentName:"p"},"include")," folder could be put to correct include path of your system, e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"/usr/local/include/"),", so that protoc can find them while compiling."),(0,r.kt)("h3",{id:"2-there-are-errors-from-ide-show-import-googleapiannotationsproto-with-red-wavy-line"},"2. There are errors from IDE show ",(0,r.kt)("inlineCode",{parentName:"h3"},'import "google/api/annotations.proto";')," with red wavy line"),(0,r.kt)("p",null,"You can append ",(0,r.kt)("inlineCode",{parentName:"p"},"thrid_party")," directory to custom protobuf`s include paths. Please follow these doc:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/ksprojects/protobuf-jetbrains-plugin#configuration"},"GoLand")," "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/zxh0/vscode-proto3#extension-settings"},"VSCode"))),(0,r.kt)("h3",{id:"3-develop-with-goland"},"3. Develop with goland"),(0,r.kt)("p",null,"All you need to do is configurate some setting like this:"),(0,r.kt)("img",{src:"/images/goland.png",width:"650px"}),(0,r.kt)("h3",{id:"4-the-code-newly-generated-after-the-new-release-is-unavailable-with-system-alarming-errors"},"4. The code newly generated after the new release is unavailable, with system alarming errors."),(0,r.kt)("p",null,"You can try to follow this:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"kratos upgrade"),(0,r.kt)("li",{parentName:"ol"},"Modify the version of kratos in ",(0,r.kt)("inlineCode",{parentName:"li"},"go.mod")," file"),(0,r.kt)("li",{parentName:"ol"},"go generate ./...")),(0,r.kt)("h3",{id:"5-after-invoke-kratos-client-there-are-no-deserved-http-file"},"5. After invoke ",(0,r.kt)("inlineCode",{parentName:"h3"},"kratos client"),", there are no deserved http file."),(0,r.kt)("p",null,"You can run ",(0,r.kt)("inlineCode",{parentName:"p"},"make http")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"kratos client xxx --go-http_opt=omitempty=false")),(0,r.kt)("h3",{id:"6-it-show-command-not-found-kratos-after-installed-kratos"},"6. It show ",(0,r.kt)("inlineCode",{parentName:"h3"},"Command not found: kratos")," after installed Kratos"),(0,r.kt)("p",null,"Make sure the env value ",(0,r.kt)("inlineCode",{parentName:"p"},"PATH")," contain ",(0,r.kt)("inlineCode",{parentName:"p"},"GOBIN")," directory. Or you can invoke ",(0,r.kt)("inlineCode",{parentName:"p"},"kratos")," inside ",(0,r.kt)("inlineCode",{parentName:"p"},"GOBIN")," directory."),(0,r.kt)("h3",{id:"7-it-show-some-proto-file-not-found-when-generate-pb-file"},"7. It show some proto file not found when generate pb file."),(0,r.kt)("p",null,"Copy the missing proto file to ",(0,r.kt)("inlineCode",{parentName:"p"},"third_party")," directory. Or append missing proto file location to corresponding Makefile command."),(0,r.kt)("h3",{id:"8there-are---no-validation-rules-for-xxxx-for-configurated-property"},"8.There are  ",(0,r.kt)("inlineCode",{parentName:"h3"},"// no validation rules for xxxx")," for configurated property."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"git clone github.com/envoyproxy/protoc-gen-validate\ncd protoc-gen-validate\nmake build\n")),(0,r.kt)("h3",{id:"9-custom-http-return-value"},"9. Custom Http return value"),(0,r.kt)("p",null,"You can write a custom ",(0,r.kt)("inlineCode",{parentName:"p"},"ResponseEncoder")," and set to ",(0,r.kt)("inlineCode",{parentName:"p"},"http.Server()")," by using ",(0,r.kt)("inlineCode",{parentName:"p"},"http.ResponseEncoder()")),(0,r.kt)("h3",{id:"10-how-to-control-the-http-return-field-0-value-ignore-field-and-use-protos-message-field-as-the-http-return-field"},"10. How to control the http return field 0 value ignore field and use proto's message field as the http return field"),(0,r.kt)("p",null,"You can import it in the ",(0,r.kt)("inlineCode",{parentName:"p"},"main.go")," of the http service"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'import (\n  "github.com/go-kratos/kratos/v2/encoding/json"\n  "google.golang.org/protobuf/encoding/protojson"\n)\n')),(0,r.kt)("p",null,"Set ",(0,r.kt)("inlineCode",{parentName:"p"},"json.MarshalOptions")," in the init method"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'func init() {\n    flag.StringVar(&flagconf, "conf", "../../configs", "config path, eg: -conf config.yaml")\n    //Add this code\n    json.MarshalOptions = protojson.MarshalOptions{\n        EmitUnpopulated: true, //Default value not ignored\n        UseProtoNames:   true, //Use proto name to return http field\n    }\n}\n')),(0,r.kt)("h3",{id:"11controls-the-name-and-number-of-the-enum-enumeration-type-returned-by-http"},"11\u3001Controls the name and number of the enum (enumeration type) returned by http"),(0,r.kt)("p",null,"You can import it in the ",(0,r.kt)("inlineCode",{parentName:"p"},"main.go")," of the http service"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'import (\n  "github.com/go-kratos/kratos/v2/encoding/json"\n  "google.golang.org/protobuf/encoding/protojson"\n)\n')),(0,r.kt)("p",null,"Set ",(0,r.kt)("inlineCode",{parentName:"p"},"json.MarshalOptions")," in the init method"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'func init() {\n    flag.StringVar(&flagconf, "conf", "../../configs", "config path, eg: -conf config.yaml")\n    // Add this code\n    json.MarshalOptions = protojson.MarshalOptions{\n        UseEnumNumbers: true, // UseEnumNumbers emits enum values as numbers.\n    }\n}\n')),(0,r.kt)("p",null,"For more control over http return content, please refer to the documentation: ",(0,r.kt)("a",{parentName:"p",href:"https://pkg.go.dev/google.golang.org/protobuf@v1.30.0/encoding/protojson#MarshalOptions"},"https://pkg.go.dev/google.golang.org/protobuf@v1.30.0/encoding/protojson#MarshalOptions")))}u.isMDXComponent=!0}}]);